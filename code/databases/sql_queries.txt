
-- 1.
SELECT EMPLOYEE.FNAME, EMPLOYEE.MINIT, EMPLOYEE.LNAME 
FROM EMPLOYEE JOIN WORKS_ON ON EMPLOYEE.SSN = WORKS_ON.ESSN
  JOIN PROJECT ON PROJECT.PNUMBER = WORKS_ON.PNO
WHERE EMPLOYEE.DNO = 5 AND PROJECT.PNAME = 'ProductX'
  AND WORKS_ON.HOURS > 25;

-- 2.  
SELECT EMPLOYEE.FNAME, EMPLOYEE.MINIT, EMPLOYEE.LNAME
FROM EMPLOYEE JOIN DEPENDENT ON EMPLOYEE.SSN = DEPENDENT.ESSN
WHERE EMPLOYEE.FNAME = DEPENDENT.DEPENDENT_NAME
  AND DEPENDENT.RELATIONSHIP = 'Daughter';
 
-- 3.
SELECT EMPLOYEE.FNAME, EMPLOYEE.MINIT, EMPLOYEE.LNAME
FROM EMPLOYEE
WHERE EMPLOYEE.SUPER_SSN = 
  (SELECT EMPLOYEE.SSN FROM EMPLOYEE WHERE 
   EMPLOYEE.FNAME = 'James' AND EMPLOYEE.MINIT = 'E' 
   AND EMPLOYEE.LNAME = 'Borg');
 
-- 4.
SELECT PROJECT.PNAME, PROJECT.PNUMBER, SUM(WORKS_ON.HOURS)
FROM PROJECT JOIN WORKS_ON ON PROJECT.PNUMBER = WORKS_ON.PNO 
GROUP BY PROJECT.PNAME, PROJECT.PNUMBER;

-- 5.
SELECT EMPLOYEE.FNAME, EMPLOYEE.MINIT, EMPLOYEE.LNAME
FROM EMPLOYEE
WHERE EMPLOYEE.SSN = (
  SELECT WORKS_ON.ESSN
  FROM PROJECT JOIN WORKS_ON ON PROJECT.PNUMBER = WORKS_ON.PNO
  GROUP BY WORKS_ON.ESSN
  HAVING COUNT(WORKS_ON.ESSN) = 6);
  
-- 6.
SELECT EMPLOYEE.FNAME, EMPLOYEE.MINIT, EMPLOYEE.LNAME
FROM EMPLOYEE LEFT JOIN WORKS_ON ON EMPLOYEE.SSN = WORKS_ON.ESSN
WHERE PNO IS NULL;

-- 7.
SELECT DEPARTMENT.DNAME, AVG(SALARY)
FROM DEPARTMENT JOIN EMPLOYEE ON DEPARTMENT.DNUMBER = EMPLOYEE.DNO 
GROUP BY DEPARTMENT.DNAME;

-- 8.
SELECT AVG(SALARY)
FROM EMPLOYEE
WHERE SEX = 'M';

-- 9.
SELECT DISTINCT EMPLOYEE.FNAME, EMPLOYEE.MINIT, EMPLOYEE.LNAME, EMPLOYEE.ADDRESS
FROM EMPLOYEE JOIN WORKS_ON ON EMPLOYEE.SSN = WORKS_ON.ESSN
  JOIN PROJECT ON WORKS_ON.PNO = PROJECT.PNUMBER
  JOIN DEPT_LOCATIONS ON PROJECT.DNUM = DEPT_LOCATIONS.DNUMBER
WHERE PROJECT.PLOCATION = 'Houston' AND DEPT_LOCATIONS.DLOCATION <> 'Houston';

-- 10.
SELECT EMPLOYEE.LNAME
FROM EMPLOYEE JOIN DEPARTMENT ON EMPLOYEE.SSN = DEPARTMENT.MGR_SSN
  LEFT JOIN DEPENDENT ON DEPARTMENT.MGR_SSN = DEPENDENT.ESSN
WHERE DEPENDENT.ESSN IS NULL;

-- 11.
SELECT DEPARTMENT.DNAME, COUNT(EMPLOYEE.SSN)
FROM EMPLOYEE JOIN DEPARTMENT ON EMPLOYEE.DNO = DEPARTMENT.DNUMBER 
GROUP BY DEPARTMENT.DNAME
HAVING AVG(SALARY) < 50000;

-- 12.
SELECT EMPLOYEE.FNAME, EMPLOYEE.MINIT, EMPLOYEE.LNAME
FROM EMPLOYEE JOIN DEPARTMENT ON EMPLOYEE.DNO = DEPARTMENT.DNUMBER
WHERE EMPLOYEE.DNO = 
  (SELECT EMPLOYEE.DNO 
   FROM EMPLOYEE
   WHERE EMPLOYEE.SALARY =
    (SELECT MIN(SALARY)
     FROM EMPLOYEE));
     
-- 13.
SELECT EMPLOYEE.FNAME, EMPLOYEE.MINIT, EMPLOYEE.LNAME
FROM EMPLOYEE
WHERE EMPLOYEE.SUPER_SSN = ANY 
  (SELECT EMPLOYEE.SSN
   FROM EMPLOYEE
   WHERE EMPLOYEE.SUPER_SSN = 888665555);
   
-- 14.
SELECT EMPLOYEE.FNAME, EMPLOYEE.MINIT, EMPLOYEE.LNAME
FROM EMPLOYEE
WHERE SALARY >= 
  ((SELECT MAX(SALARY)
    FROM EMPLOYEE) - 10000) AND SALARY <>
    (SELECT MAX(SALARY)
     FROM EMPLOYEE);